<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sd.mommyson.manager.dao.ManagerDAO">
	<resultMap type="com.sd.mommyson.member.dto.AuthDTO" id="authResultMap">
		<id property="code" column="CODE"/>
		<result property="auth" column="AUTH"/>
	</resultMap>
	
	<select id="selectAuth" resultMap="authResultMap">
		SELECT
			   A.CODE
			 , A.AUTH
		  FROM AUTH_TBL A
		 WHERE A.CODE != 6
	</select>
	
	<update id="updateAuth" parameterType="hashmap">
		UPDATE MANAGER_TBL
		   SET CODE = #{ selected }
		 WHERE MEM_CODE = #{ memCode }
	</update>
	
	<insert id="insertNewManager" parameterType="hashmap">
		INSERT ALL
		INTO MEMBER_TBL VALUES(SEQ_MEMBER.nextval, NULL, #{ member.memPwd }, NULL, NULL, NULL, NULL, 'manager', 'L0', '관리자', #{ member.memId }, SYSDATE, 'N')
		INTO MANAGER_TBL VALUES(SEQ_MEMBER.currval, SYSDATE, #{ code })
		SELECT * FROM DUAL
	</insert>
	
	<select id="selectManagerByMemCode" resultType="hashmap">
		SELECT
			   A.MEM_CODE
			 , A.MEM_ID
			 , B.CODE
		  FROM MEMBER_TBL A
		  JOIN MANAGER_TBL B ON(A.MEM_CODE = B.MEM_CODE)
		 WHERE A.MEM_CODE = #{ memCode }
	</select>
</mapper>